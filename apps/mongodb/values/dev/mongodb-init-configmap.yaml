apiVersion: v1
kind: ConfigMap
metadata:
  name: mongodb-init
  namespace: mongodb-dev
data:
  init-replica.js: |
    rs.initiate(
      {
        _id: "rs0",
        members: [
          { _id: 0, host: "mongodb-0.mongodb:27017", priority: 10 },
          { _id: 1, host: "mongodb-1.mongodb:27017", priority: 1 },
          { _id: 2, host: "mongodb-2.mongodb:27017", priority: 1 }
        ]
      }
    );

    // Esperar a que se establezca la replicaci√≥n
    while (!rs.isMaster().ismaster) {
      print("Esperando a que este nodo se convierta en maestro...");
      sleep(1000);
    }
    
    print("Replica set configurado correctamente. Este nodo es ahora el primario.");
